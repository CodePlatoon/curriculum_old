# Tuesday, May 19, 2020

## Video Resources (Kilo Platoon)
- [Week 3 Videos](https://www.youtube.com/playlist?list=PLu0CiQ7bzwEQVUa4JoR-lj3JM9OOyd6PV)

## Topics Covered
- CSV as a Database
    - Every application relies on persistent data; you'll need to know how to create, read, update, and delete it
    - CSV files are the most commonly used type of persistent data source for business people (think Excel)
- Object Oriented Programming Review

## Goals
**Core**
- Be able to read and manipulate CSV files via Python
- Understand the structure and modes of a CSV file
    - Is there a header, and should you use `reader` or `DictReader`?
- Store data throughout different runs of an app

## Lesson

**What is a Database?**
- A _database_ is a system of storing and organizing information on a computer. We `query` the database using `SQL` (to be covered next week). In preparation for next week, we will be reading/writing to a _CSV_ file. In most cases a database can be thought of as a table or group of tables:

| ID | Team     | Wins  | Losses   |
|:---|:-------- |:------|:---------|
| 1  | Patriots | 10    | 2        |
| 2  | Bears    | 2     | 10       |
| 3  | Jets     | 5     | 5        |


**What is a CSV file?**
- CSV stands for Comma-Separated Values, and it's used to store persistent data.
- A CSV file is a plain text file used to store data as a table, like above. Each line of the file is a separate data entry (row), and the value of the entry is separated by a `,` (column). The `,` in this case is called the `delimiter`, the character or sequence of characters that indicates the separation of data.
- CSV files sometimes include headers. The header will be the first row of the file and will describe what each column represents. The basic format of a CSV file (with two columns, three rows, and a header in this example) is shown below:
```
column 1 name,column 2 name (optional)
entry 1 column 1 value,entry 1 column 2 value
entry 2 column 1 value,entry 2 column 2 value
entry 3 column 1 value,entry 3 column 2 value
```

**Reading from a CSV**
- Let's say that we have a `nfl_teams.csv` file with the following data:
```
id,team,wins,losses
1,Patriots,10,2
2,Bears,2,10
3,Jets,5,5
```

- We're going to use Python's built in CSV library to read that information below. Check the [Python Docs](https://docs.python.org/3/library/csv.html) to figure out what's going on - if that's too much heavy reading, [this](https://realpython.com/python-csv/) is also a great resource.

```python
import csv
with open('nfl_teams.csv') as csv_file:
    csv_reader = csv.reader(csv_file)
    for row in csv_reader:
        print(row)
```

- You should get an output of:
```
['id', 'team', 'wins', 'losses']
['1', 'Patriots', '10', '2']
['2', 'Bears', '2', '10']
['3', 'Jets', '5', '5']
```

- A few things to note here: we have access to every row from the CSV file and every row is returned as an array of elements. If we wanted to read it back as a `dictionary` (technically, an ordered dictionary), we'd alter the code above as:

```python
import csv

with open('nfl_teams.csv') as csv_file:
    csv_reader = csv.DictReader(csv_file)
    for row in csv_reader:
        print(row)
```

- Your output should look like:

```
OrderedDict([('id', '1'), ('team', 'Patriots'), ('wins', '10'), ('losses', '2')])
OrderedDict([('id', '2'), ('team', 'Bears'), ('wins', '2'), ('losses', '10')])
OrderedDict([('id', '3'), ('team', 'Jets'), ('wins', '5'), ('losses', '5')])
```

- Here, we get back `OrderedDict` objects and we can access the values based off of the keys (i.e., `row['id']`, `row['losses']`). Since dictionaries inherently do not keep track of order, we need the `OrderedDict` object to keep track of order for us.

**Modes in CSV classes**
- To unlock additional features we can add modes, for example, `open('nfl_teams.csv', mode='w')`

|Mode |  Meaning
|:---:|-----------------------------------------------------------|
|"r"  |  Read-only, starts at beginning of file  (default mode)   |
|"r+" |  Read-write, starts at beginning of file.                 |
|"w"  |  Write-only, truncates existing file to zero length       |
|"w+" |  Read-write, truncates existing file to zero length.      |
|"a"  |  Append write-only, starts at end of file if file exists. |
|"a+" |  Append read-write, starts at end of file if file exists. |
|"b"  |  Binary file mode                                         |
|"t"  |  Text file mode                                           |

**Writing to a CSV**
- Using that same NFL dataset above, let's write some data to the CSV file. Take a look at the code below:

```python
import csv

with open('nfl_teams.csv', mode='w') as nfl_file:
    nfl_writer = csv.writer(nfl_file)
    nfl_writer.writerow([4,'Giants',6,4])
    nfl_writer.writerow([5,'Lions',8,2])
```

- Uh oh! We overwrote everything! Remember that the `w` mode overwrites everything. If we wanted to append to the end, we have to change the mode to `a`. Let's undo that change and try again. Did it append correctly?

- If you didn't have a `newline` at the bottom of your file, it may have smushed two lines together. It's a good habit to have an empty line at the bottom of all your text files.

- You can also write to a CSV using a dictionary instead of an array, which I recommend as it's more precise:

```python
import csv

with open('nfl_teams.csv', mode='a') as csv_file:
    fieldnames = ['id', 'team', 'wins', 'losses']
    nfl_writer = csv.DictWriter(csv_file, fieldnames=fieldnames)

    nfl_writer.writerow({'id': 4,'team': 'Giants', 'wins': 6, 'losses': 4})
    nfl_writer.writerow({'id': 5,'team':'Lions','wins': 8,'losses': 2})

```

## External Resources
- [CSV Parsing Review](https://www.youtube.com/watch?v=q5uM4VKywbA)
- [Python CSV Documentation](https://docs.python.org/3/library/csv.html)
- [Real Python CSV Introduction](https://realpython.com/python-csv/)

## Assignments
- [Word Guess CSV](https://github.com/limaplatoon/word-guess)
- [School Interface One](https://github.com/limaplatoon/school-interface-one)
- [Bowling](https://github.com/limaplatoon/bowling)
